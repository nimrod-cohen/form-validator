window.form_validator=window.form_validator||{options:null,disposable_email_domains:null,$:null,exclamationImg:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4AIHEDcohBNxRQAAAB1pVFh0Q29tbWVudAAAAAAAQ3JlYXRlZCB3aXRoIEdJTVBkLmUHAAAAvElEQVQ4y62TTQqDMBCFv8Qsu1Ra8A7idbryytJNL9BNtgV1U6ddNMKgY6DYB4Ehb+ZNMj8OAwIN0ALndBWB3sONHARqgSgwC7xXZ05cvRfc7QRaQp2VeR08KX4yRGotEI1Mo+JHg48APhWs5HeUAk1I1faGgxc4LbbFA21QrVqjAC7KtlCFzBMLoAJcRqAMaUgsOOAKPJNt4R6A/lvozT9fwEPZYTs69Lk2Dspz2Gvjfwbp8CgfWSZ3dJ0/kSXCTm81zRsAAAAASUVORK5CYII=",init:function(t){this.$=$||jQuery,this.options=t,this.options.enable_disposables_check&&this.loadDisposableEmailDomains(),this.addForms(this.options.forms)},addForms:function(t){for(var o=0;o<t.length;o++){var i=t[o],e=this.$(i.selector);e.attr("novalidate","novalidate"),e.length>0&&this.attachChecks(e,i.callback)}},loadDisposableEmailDomains:function(){if(null==this.disposable_email_domains){var t=this;jQuery.getJSON("https://raw.githubusercontent.com/ivolo/disposable-email-domains/master/index.json",function(o){t.disposable_email_domains=o,console.log("disposable list loaded")}).error(function(){})}},attachChecks:function(t,o){for(var i=t.find("input,select,textarea"),e=0;e<i.length;e++)"submit"!=this.$(i[e]).attr("type")&&(this.$(i[e]).focus(this.doClean),this.$(i[e]).blur(this.doCheck),console.log(i[e]));var a=t.find("input[type='submit'], button[type='submit']"),r=this;a.click(function(t){return t.preventDefault(),r.validateForm(t,o),!1})},validateForm:function(t,o){var i=window.form_validator;console.log("validating form");for(var e=i.$(t.target).closest("form"),a=e.find("input,select,textarea"),r=!1,n=0;n<a.length;n++)"submit"!=i.$(a[n]).attr("type")&&(i.cleanField(i.$(a[n])),i.checkField(i.$(a[n]))||(r=!0));r||o(e.get(0))},doCheck:function(){var t=window.form_validator;t.checkField(t.$(this))},checkField:function(t){console.log("checking: "+t.attr("name"));var o=t.val()?t.val().trim():"",i=t.attr("type");if(i=i||"unknown",t.attr("required")&&(0==o.length||"checkbox"==i&&!t.is(":checked")))return window.form_validator.showError(t,"mandatory_field"),!1;if(o.length>0)switch(i){case"email":if(!window.form_validator.checkEmail(t,o))return!1;break;case"tel":if(!window.form_validator.checkPhone(t,o))return!1;break;case"text":if(t.attr("list")&&!window.form_validator.checkList(t,o))return!1}return!0},checkList:function(t,o){for(var i=window.form_validator,e=i.$(t.attr("list")).find("option"),a=0;a<e.length;a++)if(i.$(e[a]).val().toLowerCase()==o.toLowerCase())return!0;return this.showError(t,"invalid_list_value"),!1},checkPhone:function(t,o){var i=o.replace(/\D/g,"");return!(o.length>0&&(!/^\+?[\d\. \-\(\)]{7,}$/g.test(o)||i.length<7||i.length>12))||(this.showError(t,"wrong_phone_format"),!1)},checkEmail:function(t,o){if(o.length>0&&!/^([\w\.\-_]+)?\w+@[\w\-\_]+(\.\w+){1,}$/gi.test(o))return this.showError(t,"invalid_email_address"),!1;var i=o.substr(o.indexOf("@")+1).trim();return!(o.length>0&&this.options.enable_disposables_check&&this.disposable_email_domains&&this.disposable_email_domains.indexOf(i)>=0)||(t.status="failed",this.showError(t,"invalid_email_address"),!1)},showError:function(t,o){var i=window.form_validator,e="rtl"==t.css("direction"),a=i.options.error_background?i.options.error_background:"rgba(255,0,0,0.1)";t.css("background-color",a);var r=t.attr("name");console.log(r+" "+o);var n=t.position(),s=t.outerHeight(),l=t.outerWidth(),d="err_"+(Math.floor(999001*Math.random())+1e3);t.attr("error-id",d),t.parent().append("<span id='"+d+"' field-name='"+r+"'><img class='exclamation-error' style='width:16px; height:16px;' src='"+i.exclamationImg+"' /></span>");var c=n.top+(s-16)/2,h=n.left+(e?20:l-20);i.$("span#"+d).css({position:"absolute",top:c,left:h,"z-index":"100000"})},cleanField:function(t){var o=window.form_validator,i=t.attr("name"),e=t.attr("error-id");void 0!==e&&(console.log("cleaning :"+i),t.css("background-color",""),o.$("span#"+e).remove(),t.removeAttr("error-id"))},doClean:function(){var t=window.form_validator;t.cleanField(t.$(this))}};