window.form_validator=window.form_validator||{options:null,disposable_email_domains:null,exclamationImg:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4AIHEDcohBNxRQAAAB1pVFh0Q29tbWVudAAAAAAAQ3JlYXRlZCB3aXRoIEdJTVBkLmUHAAAAvElEQVQ4y62TTQqDMBCFv8Qsu1Ra8A7idbryytJNL9BNtgV1U6ddNMKgY6DYB4Ehb+ZNMj8OAwIN0ALndBWB3sONHARqgSgwC7xXZ05cvRfc7QRaQp2VeR08KX4yRGotEI1Mo+JHg48APhWs5HeUAk1I1faGgxc4LbbFA21QrVqjAC7KtlCFzBMLoAJcRqAMaUgsOOAKPJNt4R6A/lvozT9fwEPZYTs69Lk2Dspz2Gvjfwbp8CgfWSZ3dJ0/kSXCTm81zRsAAAAASUVORK5CYII=",init:function(o){this.options=o,this.options.enable_disposables_check&&this.loadDisposableEmailDomains(),this.addForms(this.options.forms)},addForms:function(o){for(var t=0;t<o.length;t++){var e=o[t],i=$(e.selector);i.attr("novalidate","novalidate"),i.length>0&&this.attachChecks(i,e.callback)}},loadDisposableEmailDomains:function(){if(null==this.disposable_email_domains){var o=this;jQuery.getJSON("https://raw.githubusercontent.com/ivolo/disposable-email-domains/master/index.json",function(t){o.disposable_email_domains=t,console.log("disposable list loaded")}).error(function(){})}},attachChecks:function(o,t){for(var e=o.find("input,select,textarea"),i=0;i<e.length;i++)"submit"!=$(e[i]).attr("type")&&($(e[i]).focus(this.clean),$(e[i]).blur(this.check),console.log(e[i]));var a=o.find("input[type='submit'], button[type='submit']"),r=this;a.click(function(o){o.preventDefault(),r.validateForm(o,t)})},validateForm:function(o,t){console.log("validating form");for(var e=$(o.target).closest("form"),i=e.find("input,select,textarea"),a=!1,r=0;r<i.length;r++)"submit"!=$(i[r]).attr("type")&&(window.form_validator.doCheck(i[r])||(a=!0));a||t(e.get(0))},check:function(){window.form_validator.doCheck(this)},doCheck:function(o){console.log("checking: "+o.name),o=$(o);var t=o.val()?o.val().trim():"",e=o.prop("type");if(e=e||"unknown",o.prop("required")&&(0==t.length||"checkbox"==e&&!o.is(":checked")))return window.form_validator.showError(o,"mandatory_field"),!1;if(t.length>0)switch(e){case"email":if(!window.form_validator.checkEmail(o,t))return!1;break;case"tel":if(!window.form_validator.checkPhone(o,t))return!1;break;case"text":if(o.prop("list")&&!window.form_validator.checkList(o,t))return!1}return!0},checkList:function(o,t){for(var e=$(o.prop("list")).find("option"),i=0;i<e.length;i++)if($(e[i]).val().toLowerCase()==t.toLowerCase())return!0;return this.showError(o,"invalid_list_value"),!1},checkPhone:function(o,t){var e=/^\+?[\d\. \-\(\)]{7,}$/g,i=t.replace(/\D/g,"");return t.length>0&&(!e.test(t)||i.length<7||i.length>12)?(this.showError(o,"wrong_phone_format"),!1):!0},checkEmail:function(o,t){var e=/^([\w\.\-_]+)?\w+@[\w\-\_]+(\.\w+){1,}$/gi;if(t.length>0&&!e.test(t))return this.showError(o,"invalid_email_address"),!1;var i=t.substr(t.indexOf("@")+1).trim();return t.length>0&&this.options.enable_disposables_check&&this.disposable_email_domains&&this.disposable_email_domains.indexOf(i)>=0?(o.status="failed",this.showError(o,"invalid_email_address"),!1):!0},showError:function(o,t){o.css("background-color","#FFDECA");var e=o.prop("name");console.log(e+" "+t);var i=o.offset(),a=o.outerHeight(),r=o.outerWidth(),n="err_"+(Math.floor(999001*Math.random())+1e3);o.prop("error-id",n),$(document.body).append("<span id='"+n+"' field-name='"+e+"'><img src='"+window.form_validator.exclamationImg+"' /></span>");var s=i.top+(a-16)/2,l=i.left+r-20;$("span#"+n).css({position:"absolute",top:s,left:l,"z-index":"100000"})},clean:function(){var o=$(this),t=o.prop("name"),e=o.prop("error-id");console.log("cleaning :"+t),o.css("background-color",""),$("span#"+e).remove(),o.removeProp("error-id")}};