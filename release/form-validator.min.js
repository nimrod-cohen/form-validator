window.form_validator=window.form_validator||{options:null,disposable_email_domains:null,exclamationImg:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4AIHEDcohBNxRQAAAB1pVFh0Q29tbWVudAAAAAAAQ3JlYXRlZCB3aXRoIEdJTVBkLmUHAAAAvElEQVQ4y62TTQqDMBCFv8Qsu1Ra8A7idbryytJNL9BNtgV1U6ddNMKgY6DYB4Ehb+ZNMj8OAwIN0ALndBWB3sONHARqgSgwC7xXZ05cvRfc7QRaQp2VeR08KX4yRGotEI1Mo+JHg48APhWs5HeUAk1I1faGgxc4LbbFA21QrVqjAC7KtlCFzBMLoAJcRqAMaUgsOOAKPJNt4R6A/lvozT9fwEPZYTs69Lk2Dspz2Gvjfwbp8CgfWSZ3dJ0/kSXCTm81zRsAAAAASUVORK5CYII=",init:function(t){this.options=t,this.options.enable_disposables_check&&this.loadDisposableEmailDomains(),this.addForms(this.options.forms)},addForms:function(t){for(var o=0;o<t.length;o++){var e=t[o],i=$(e.selector);i.attr("novalidate","novalidate"),i.length>0&&this.attachChecks(i,e.callback)}},loadDisposableEmailDomains:function(){if(null==this.disposable_email_domains){var t=this;jQuery.getJSON("https://raw.githubusercontent.com/ivolo/disposable-email-domains/master/index.json",function(o){t.disposable_email_domains=o,console.log("disposable list loaded")}).error(function(){})}},attachChecks:function(t,o){for(var e=t.find("input,select,textarea"),i=0;i<e.length;i++)"submit"!=$(e[i]).attr("type")&&($(e[i]).focus(this.clean),$(e[i]).blur(this.check),console.log(e[i]));var a=t.find("input[type='submit'], button[type='submit']"),r=this;a.click(function(t){t.preventDefault(),r.validateForm(t,o)})},validateForm:function(t,o){console.log("validating form");for(var e=$(t.target).closest("form"),i=e.find("input,select,textarea"),a=!1,r=0;r<i.length;r++)"submit"!=$(i[r]).attr("type")&&(window.form_validator.doCheck(i[r])||(a=!0));a||o(e.get(0))},check:function(){window.form_validator.doCheck(this)},doCheck:function(t){console.log("checking: "+t.name),t=$(t);var o=t.val()?t.val().trim():"",e=t.attr("type");if(e=e||"unknown",t.attr("required")&&(0==o.length||"checkbox"==e&&!t.is(":checked")))return window.form_validator.showError(t,"mandatory_field"),!1;if(o.length>0)switch(e){case"email":if(!window.form_validator.checkEmail(t,o))return!1;break;case"tel":if(!window.form_validator.checkPhone(t,o))return!1;break;case"text":if(t.attr("list")&&!window.form_validator.checkList(t,o))return!1}return!0},checkList:function(t,o){for(var e=$(t.attr("list")).find("option"),i=0;i<e.length;i++)if($(e[i]).val().toLowerCase()==o.toLowerCase())return!0;return this.showError(t,"invalid_list_value"),!1},checkPhone:function(t,o){var e=/^\+?[\d\. \-\(\)]{7,}$/g,i=o.replace(/\D/g,"");return o.length>0&&(!e.test(o)||i.length<7||i.length>12)?(this.showError(t,"wrong_phone_format"),!1):!0},checkEmail:function(t,o){var e=/^([\w\.\-_]+)?\w+@[\w\-\_]+(\.\w+){1,}$/gi;if(o.length>0&&!e.test(o))return this.showError(t,"invalid_email_address"),!1;var i=o.substr(o.indexOf("@")+1).trim();return o.length>0&&this.options.enable_disposables_check&&this.disposable_email_domains&&this.disposable_email_domains.indexOf(i)>=0?(t.status="failed",this.showError(t,"invalid_email_address"),!1):!0},showError:function(t,o){var e=this.options.error_background?this.options.error_background:"rgba(255,0,0,0.1)";t.css("background-color",e);var i=t.attr("name");console.log(i+" "+o);var a=t.position(),r=t.outerHeight(),n=t.outerWidth(),s="err_"+(Math.floor(999001*Math.random())+1e3);t.attr("error-id",s),t.parent().append("<span id='"+s+"' field-name='"+i+"'><img src='"+window.form_validator.exclamationImg+"' /></span>");var l=a.top+(r-16)/2,d=a.left+n-20;$("span#"+s).css({position:"absolute",top:l,left:d,"z-index":"100000"})},clean:function(){var t=$(this),o=t.attr("name"),e=t.attr("error-id");"undefined"!=typeof e&&(console.log("cleaning :"+o),t.css("background-color",""),$("span#"+e).remove(),t.removeAttr("error-id"))}};