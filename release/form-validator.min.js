window.form_validator=window.form_validator||{options:null,disposable_email_domains:null,$:null,exclamationImg:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4AIHEDcohBNxRQAAAB1pVFh0Q29tbWVudAAAAAAAQ3JlYXRlZCB3aXRoIEdJTVBkLmUHAAAAvElEQVQ4y62TTQqDMBCFv8Qsu1Ra8A7idbryytJNL9BNtgV1U6ddNMKgY6DYB4Ehb+ZNMj8OAwIN0ALndBWB3sONHARqgSgwC7xXZ05cvRfc7QRaQp2VeR08KX4yRGotEI1Mo+JHg48APhWs5HeUAk1I1faGgxc4LbbFA21QrVqjAC7KtlCFzBMLoAJcRqAMaUgsOOAKPJNt4R6A/lvozT9fwEPZYTs69Lk2Dspz2Gvjfwbp8CgfWSZ3dJ0/kSXCTm81zRsAAAAASUVORK5CYII=",init:function(a){this.$=$||jQuery,this.options=a,this.options.enable_disposables_check&&this.loadDisposableEmailDomains(),this.addForms(this.options.forms)},addForms:function(a){for(var b=0;b<a.length;b++){var c=a[b],d=this.$(c.selector);d.attr("novalidate","novalidate"),d.length>0&&this.attachChecks(d,c.callback)}},loadDisposableEmailDomains:function(){if(null==this.disposable_email_domains){var a=this;jQuery.getJSON("https://raw.githubusercontent.com/ivolo/disposable-email-domains/master/index.json",function(b){a.disposable_email_domains=b,console.log("disposable list loaded")}).error(function(){})}},attachChecks:function(a,b){for(var c=a.find("input,select,textarea"),d=0;d<c.length;d++)"submit"!=this.$(c[d]).attr("type")&&(this.$(c[d]).focus(this.doClean),this.$(c[d]).blur(this.doCheck),console.log(c[d]));var e=a.find("input[type='submit'], button[type='submit']"),f=this;e.click(function(a){a.preventDefault(),f.validateForm(a,b)})},validateForm:function(a,b){var c=window.form_validator;console.log("validating form");for(var d=c.$(a.target).closest("form"),e=d.find("input,select,textarea"),f=!1,g=0;g<e.length;g++)"submit"!=c.$(e[g]).attr("type")&&(c.cleanField(c.$(e[g])),c.checkField(c.$(e[g]))||(f=!0));f||b(d.get(0))},doCheck:function(){var a=window.form_validator;a.checkField(a.$(this))},checkField:function(a){console.log("checking: "+a.attr("name"));var b=a.val()?a.val().trim():"",c=a.attr("type");if(c=c||"unknown",a.attr("required")&&(0==b.length||"checkbox"==c&&!a.is(":checked")))return window.form_validator.showError(a,"mandatory_field"),!1;if(b.length>0)switch(c){case"email":if(!window.form_validator.checkEmail(a,b))return!1;break;case"tel":if(!window.form_validator.checkPhone(a,b))return!1;break;case"text":if(a.attr("list")&&!window.form_validator.checkList(a,b))return!1}return!0},checkList:function(a,b){for(var c=window.form_validator,d=c.$(a.attr("list")).find("option"),e=0;e<d.length;e++)if(c.$(d[e]).val().toLowerCase()==b.toLowerCase())return!0;return this.showError(a,"invalid_list_value"),!1},checkPhone:function(a,b){var c=/^\+?[\d\. \-\(\)]{7,}$/g,d=b.replace(/\D/g,"");return!(b.length>0&&(!c.test(b)||d.length<7||d.length>12))||(this.showError(a,"wrong_phone_format"),!1)},checkEmail:function(a,b){var c=/^([\w\.\-_]+)?\w+@[\w\-\_]+(\.\w+){1,}$/gi;if(b.length>0&&!c.test(b))return this.showError(a,"invalid_email_address"),!1;var d=b.substr(b.indexOf("@")+1).trim();return!(b.length>0&&this.options.enable_disposables_check&&this.disposable_email_domains&&this.disposable_email_domains.indexOf(d)>=0)||(a.status="failed",this.showError(a,"invalid_email_address"),!1)},showError:function(a,b){var c=window.form_validator,d="rtl"==a.css("direction"),e=c.options.error_background?c.options.error_background:"rgba(255,0,0,0.1)";a.css("background-color",e);var f=a.attr("name");console.log(f+" "+b);var g=a.position(),h=a.outerHeight(),i=a.outerWidth(),j="err_"+(Math.floor(999001*Math.random())+1e3);a.attr("error-id",j),a.parent().append("<span id='"+j+"' field-name='"+f+"'><img src='"+c.exclamationImg+"' /></span>");var k=g.top+(h-16)/2,l=g.left+(d?20:i-20);c.$("span#"+j).css({position:"absolute",top:k,left:l,"z-index":"100000"})},cleanField:function(a){var b=window.form_validator,c=a.attr("name"),d=a.attr("error-id");"undefined"!=typeof d&&(console.log("cleaning :"+c),a.css("background-color",""),b.$("span#"+d).remove(),a.removeAttr("error-id"))},doClean:function(){var a=window.form_validator;a.cleanField(a.$(this))}};